<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Startup Tracker
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Startup Tracker</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="container">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Track New Company Registrations</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>Monitor newly registered companies and analyze startup trends across the UK</p>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>
        <ion-card-title>Filters</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Location</ion-label>
          <ion-input [(ngModel)]="location" placeholder="e.g., London, Manchester"></ion-input>
        </ion-item>

        <div class="ion-margin-top">
          <ion-label>SIC Codes (Industry Sectors)</ion-label>
          <ion-button expand="block" fill="outline" (click)="openSicCodeSelector()" class="ion-margin-top">
            Select SIC Codes
          </ion-button>
          <div class="sic-codes-container" *ngIf="selectedSicCodes.length > 0">
            <ion-chip *ngFor="let code of selectedSicCodes" (click)="removeSicCode(code)">
              <ion-label>{{ code }}</ion-label>
            </ion-chip>
          </div>
        </div>

        <ion-item class="ion-margin-top">
          <ion-label position="floating">Date From</ion-label>
          <ion-input type="date" [(ngModel)]="dateFrom"></ion-input>
        </ion-item>

        <ion-item class="ion-margin-top">
          <ion-label position="floating">Date To</ion-label>
          <ion-input type="date" [(ngModel)]="dateTo"></ion-input>
        </ion-item>

        <ion-button expand="block" (click)="loadStartups()" class="ion-margin-top" [disabled]="loading">
          <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
          <span *ngIf="!loading">Search Startups</span>
        </ion-button>

        <ion-button expand="block" fill="outline" (click)="loadDailyStartups()" class="ion-margin-top" [disabled]="loading">
          <span>Today's Registrations</span>
        </ion-button>

        <ion-text color="danger" *ngIf="error">
          <p class="ion-text-center">{{ error }}</p>
        </ion-text>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="startups.length > 0">
      <ion-card-header>
        <ion-card-title>
          Newly Registered Companies
          <ion-badge color="primary" class="ion-margin-start">{{ totalResults }}</ion-badge>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let startup of startups">
            <ion-label>
              <h2>{{ startup.companyName }}</h2>
              <p>Company Number: {{ startup.companyNumber }}</p>
              <p>Status: {{ startup.companyStatus }}</p>
              <p *ngIf="startup.location">Location: {{ startup.location }}</p>
              <p *ngIf="startup.dateOfCreation">Registered: {{ startup.dateOfCreation | date }}</p>
              <div *ngIf="startup.sicCodes && startup.sicCodes.length > 0">
                <p>SIC Codes: {{ startup.sicCodes.join(', ') }}</p>
              </div>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-card *ngIf="startups.length === 0 && !loading && searched">
      <ion-card-content>
        <p class="ion-text-center">No companies found matching your criteria</p>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
